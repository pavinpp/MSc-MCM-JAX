
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for project JAX-LaB">
      
      
      
        <link rel="canonical" href="https://example.com/">
      
      
      
        <link rel="next" href="base/">
      
      
        
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title></title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Ubuntu";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white-grey" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#jax-lab-a-python-based-accelerated-differentiable-massively-parallel-lattice-boltzmann-library-for-modeling-multiphase-and-multiphysics-flows-physics-based-machine-learning" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="" class="md-header__button md-logo" aria-label="" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              JAX-LaB's home
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white-grey" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/piyush-ppradhan/JAX-LaB" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Github
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="" class="md-nav__button md-logo" aria-label="" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/piyush-ppradhan/JAX-LaB" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Github
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    JAX-LaB's home
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    JAX-LaB's home
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#showcase" class="md-nav__link">
    <span class="md-ellipsis">
      
        Showcase
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Features
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#capabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Capabilities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Capabilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#multiphase-flow-modeling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multiphase Flow Modeling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multicomponent-flow-support" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multicomponent Flow Support
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wetting-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Wetting model
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Wetting model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#collision-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Collision Models
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lattice" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lattice
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#machine-learning" class="md-nav__link">
    <span class="md-ellipsis">
      
        Machine Learning
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute-capabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Compute Capabilities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boundary-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Boundary conditions
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accompanying-paper" class="md-nav__link">
    <span class="md-ellipsis">
      
        Accompanying Paper
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation-guide" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installation Guide
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    JAX-LaB API
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    JAX-LaB API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    JAX-LaB base
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    JAX-LaB models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="multiphase/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    JAX-LaB multiphase
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lattice/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    JAX-LaB lattice
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    JAX-LaB utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="boundary_conditions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    JAX-LaB boundary conditions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#showcase" class="md-nav__link">
    <span class="md-ellipsis">
      
        Showcase
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Features
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#capabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Capabilities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Capabilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#multiphase-flow-modeling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multiphase Flow Modeling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multicomponent-flow-support" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multicomponent Flow Support
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wetting-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Wetting model
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Wetting model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#collision-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Collision Models
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lattice" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lattice
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#machine-learning" class="md-nav__link">
    <span class="md-ellipsis">
      
        Machine Learning
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute-capabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Compute Capabilities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boundary-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Boundary conditions
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accompanying-paper" class="md-nav__link">
    <span class="md-ellipsis">
      
        Accompanying Paper
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation-guide" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installation Guide
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<p><a href="https://opensource.org/licenses/Apache-2.0"><img alt="License" src="https://img.shields.io/badge/License-Apache_2.0-blue.svg" /></a></p>
<h1 id="jax-lab-a-python-based-accelerated-differentiable-massively-parallel-lattice-boltzmann-library-for-modeling-multiphase-and-multiphysics-flows-physics-based-machine-learning">JAX-LaB: A Python-based, Accelerated, Differentiable Massively Parallel Lattice Boltzmann Library for Modeling Multiphase and Multiphysics Flows &amp; Physics-Based Machine Learning</h1>
<p>JAX-LaB is a fully differentiable, accelerated multiphysics and multiphase 2D/3D Lattice Boltzmann Method (LBM) Python library written in <a href="https://github.com/google/jax">JAX</a> and it provides a unified workflow for forward and
inverse modeling of multiphase flows. JAX-LaB is an extension of <a href="https://github.com/Autodesk/XLB">XLB</a> and adds support multiphase and multiphysics flows to the original library.</p>
<h2 id="showcase">Showcase</h2>
<!-- <p align="center">
  <img src="assets/capillary_fingering.gif" alt="" width="600">
</p>
<p align="center" width="300">
  Capillary fingering in a channel (multi-component simulation)
</p>
<p align="center">
  <img src="assets/capillary_rise.gif" alt="" width="700">
</p>
<p align="center" width="300">
  Capillary rise in parallel plates (single component, multiphase simulation)
</p> -->
<p align="center">
  <img src="assets/evaporation.gif" alt="" width="600">
</p>
<p align="center">
    Time evolution of liquid distribution in a porous medium during evaporation. Two-component (airâ€“water) system simulated with the Cascaded (central-moment) collision model.
</p>
<p align="center">
  <img src="assets/droplet_impact.gif" alt="" width="600">
</p>
<p align="center">
  On GPU in-situ rendering using <a href="https://github.com/loliverhennigh/PhantomGaze">PhantomGaze</a> library (no I/O). Droplet impact on dry surface using MRT collision model with ~16 million cells.
  (single component, multiphase simulation, density ratio: 350, fluid modeled using Peng-Robinson EOS).
</p>
<p align="center">
  <img src="assets/drainage.gif" alt="" width="600">
</p>
<p align="center">
  In-situ GPU rendering of drainage in a porous geometry. BGK collision model, 110 million cells.
</p>
<!--<p align="center">
  <img src="assets/car.png" alt="" width="500">
</p>
<p align="center">
<a href=https://www.epc.ed.tum.de/en/aer/research-groups/automotive/drivaer > DrivAer model </a> in a wind-tunnel using KBC Lattice Boltzmann Simulation with approx. 317 million cells
</p>

<p align="center">
  <img src="assets/building.png" alt="" width="700">
</p>
<p align="center">
  Airflow in to, out of, and within a building (~400 million cells)
</p>-->
<p align="center">
  <img src="assets/predicted.png" alt="" width="1000">
</p>
<p align="center">
Temporal evolution of the density field determined using neural network for the inverse multiphase flow control problem of forming a droplet at t = 900. The MLP output is used as the initial condition for LBM and the backpropagation step during training leverages the auto-differentiation capabilities of JAX-LaB (see paper for details).
</p>

<p><br></p>
<h2 id="key-features">Key Features</h2>
<ul>
<li><strong>Integration with JAX Ecosystem:</strong> The library can be easily integrated with JAX&rsquo;s robust ecosystem of machine learning libraries such as <a href="https://github.com/patrick-kidger/equinox">Equinox</a> <a href="https://github.com/google/flax">Flax</a>, <a href="https://github.com/deepmind/dm-haiku">Haiku</a>, <a href="https://github.com/deepmind/optax">Optax</a>, and many more.</li>
<li><strong>Differentiable LBM Kernels:</strong> JAX-LaB provides differentiable LBM kernels that can be used in differentiable physics and deep learning applications.</li>
<li><strong>Scalability:</strong> JAX-LaB is capable of scaling on distributed multi-GPU systems, enabling the execution of large-scale simulations on hundreds of GPUs with billions of cells.</li>
<li><strong>Support for Various LBM Boundary Conditions and Kernels:</strong> JAX-LaB supports several LBM boundary conditions and collision kernels.</li>
<li><strong>Support for Multiphase, Multiphysics and Multicomponent flows</strong>: JAX-LaB can accurately model multiphysics and multiphase flows using Shan-Chen method, simulating complex interface dynamics without tracking any interface.</li>
<li><strong>User-Friendly Interface:</strong> Written entirely in Python, JAX-LaB emphasizes a highly accessible interface that allows users to extend the library with ease and quickly set up and run new simulations.</li>
<li><strong>Leverages JAX Array and Shardmap:</strong> The library incorporates the new JAX array unified array type and JAX shardmap, providing users with a numpy-like interface. This allows users to focus solely on the semantics, leaving performance optimizations to the compiler.</li>
<li><strong>Platform Versatility:</strong> The same JAX-LaB code can be executed on a variety of platforms including multi-core CPUs, single or multi-GPU systems, TPUs, and it also supports distributed runs on multi-GPU systems or TPU Pod slices.</li>
<li><strong>Visualization:</strong> JAX-LaB provides a variety of visualization options including in-situ on GPU rendering using <a href="https://github.com/loliverhennigh/PhantomGaze">PhantomGaze</a>.</li>
</ul>
<h2 id="capabilities">Capabilities</h2>
<h3 id="multiphase-flow-modeling">Multiphase Flow Modeling</h3>
<p><strong>Shan-Chen</strong> pseudopotential method with various modifications:
- Support for <strong>high density ratio flows</strong> (tested for density ratios &gt; 10<sup>8</sup>) using improved forcing scheme.
- Incorporates <strong>Equation of State (EOS)</strong> to model multiphase flows. Currently implemented EOS include <strong>Carnahan-Starling</strong>, <strong>Peng-Robinson</strong>, <strong>Redlich-Kwong</strong>, <strong>Redlich-Kwong-Soave</strong>
and <strong>VanderWaals</strong>.
- <strong>Density ratio independent surface tension</strong> control by directly modifying pressure tensor.
- <strong>Improved wetting scheme</strong> to handle large range of contact angles <strong>without large spurious current or thick layers near solid surface</strong>.</p>
<h3 id="multicomponent-flow-support">Multicomponent Flow Support</h3>
<p>JAX-LaB takes advantage of <em>pytrees</em> for computation hence, it can <strong>model any number of components</strong> (each with their own equation of state, initial condition and boundary conditions) without any
user modification.</p>
<h2 id="wetting-model">Wetting model</h2>
<ul>
<li>Wetting behavior of fluids is modeled using the <a href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.100.053313">improved virtual density scheme</a> which avoids the need to include separate fluid-solid interaction forces commonly seen in Shan-Chen method by directly updating the near-wall densities</li>
<li>Wetting parameters can be passed by user while defining wall boundary conditions.</li>
</ul>
<h3 id="collision-models">Collision Models</h3>
<ul>
<li><strong>BGK</strong></li>
<li><strong>Multi-Relaxation Time (MRT)</strong></li>
<li><strong>Cascaded Model</strong></li>
<li><strong>KBC</strong></li>
</ul>
<h3 id="lattice">Lattice</h3>
<ul>
<li>D2Q9</li>
<li>D3Q19</li>
<li>D3Q27</li>
</ul>
<h3 id="machine-learning">Machine Learning</h3>
<ul>
<li>Easy integration with JAX&rsquo;s ecosystem of machine learning libraries</li>
<li>Differentiable LBM kernels both for single and multiphase flows</li>
<li>Differentiable boundary conditions</li>
</ul>
<h3 id="compute-capabilities">Compute Capabilities</h3>
<ul>
<li>Distributed Multi-GPU support</li>
<li>Mixed-Precision support (store vs compute)</li>
<li>Out-of-core support (coming soon)</li>
</ul>
<h3 id="output">Output</h3>
<ul>
<li>Binary and ASCII VTK output (based on PyVista library)</li>
<li>In-situ rendering using <a href="https://github.com/loliverhennigh/PhantomGaze">PhantomGaze</a> library</li>
<li><a href="https://github.com/google/orbax">Orbax</a>-based distributed asynchronous checkpointing</li>
<li>Image Output</li>
<li>3D mesh voxelizer using trimesh</li>
</ul>
<h3 id="boundary-conditions">Boundary conditions</h3>
<ul>
<li>
<p><strong>Equilibrium BC:</strong> In this boundary condition, the fluid populations are assumed to be in at equilibrium. Can be used to set prescribed velocity or pressure.</p>
</li>
<li>
<p><strong>Full-Way Bounceback BC:</strong> In this boundary condition, the velocity of the fluid populations is reflected back to the fluid side of the boundary, resulting in zero fluid velocity at the boundary.</p>
</li>
<li>
<p><strong>Half-Way Bounceback BC:</strong> Similar to the Full-Way Bounceback BC, in this boundary condition, the velocity of the fluid populations is partially reflected back to the fluid side of the boundary, resulting in a non-zero fluid velocity at the boundary.</p>
</li>
<li>
<p><strong>Do Nothing BC:</strong> In this boundary condition, the fluid populations are allowed to pass through the boundary without any reflection or modification.</p>
</li>
<li>
<p><strong>Zouhe BC:</strong> This boundary condition is used to impose a prescribed velocity or pressure profile at the boundary.</p>
</li>
<li><strong>Regularized BC:</strong> This boundary condition is used to impose a prescribed velocity or pressure profile at the boundary. This BC is more stable than Zouhe BC, but computationally more expensive.</li>
<li>
<p><strong>Extrapolation Outflow BC:</strong> A type of outflow boundary condition that uses extrapolation to avoid strong wave reflections.</p>
</li>
<li>
<p><strong>Interpolated Bounceback BC:</strong> Interpolated bounce-back boundary condition due to Bouzidi for a lattice Boltzmann method simulation.</p>
</li>
<li>
<p><strong>Convective Outflow BC</strong>: Convective outflow boundary condition, useful for porous media flows.</p>
</li>
</ul>
<h2 id="accompanying-paper">Accompanying Paper</h2>
<p>A preprint of the paper, accepted for publication in Journal of Advances in Modeling Earth Systems (JAMES), is available on <a href="https://arxiv.org/abs/2506.17713">arXiv</a>.</p>
<h2 id="installation-guide">Installation Guide</h2>
<p>To use JAX-LaB, you must first install JAX and other dependencies using the following commands:</p>
<p>Please refer to https://github.com/google/jax for the latest installation documentation. The following table is taken from <a href="https://github.com/google/jax">JAX&rsquo;s Github page</a>.</p>
<table>
<thead>
<tr>
<th>Hardware</th>
<th>Instructions</th>
</tr>
</thead>
<tbody>
<tr>
<td>CPU</td>
<td><code>pip install -U "jax[cpu]"</code></td>
</tr>
<tr>
<td>NVIDIA GPU on x86_64</td>
<td><code>pip install -U "jax[cuda12_pip]" -f https://storage.googleapis.com/jax-releases/jax_cuda_releases.html</code></td>
</tr>
<tr>
<td>Google TPU</td>
<td><code>pip install -U "jax[tpu]" -f https://storage.googleapis.com/jax-releases/libtpu_releases.html</code></td>
</tr>
<tr>
<td>AMD GPU</td>
<td>Use <a href="https://hub.docker.com/r/rocm/jax">Docker</a> or <a href="https://jax.readthedocs.io/en/latest/developer.html#additional-notes-for-building-a-rocm-jaxlib-for-amd-gpus">build from source</a>.</td>
</tr>
<tr>
<td>Apple GPU</td>
<td>Follow <a href="https://developer.apple.com/metal/jax/">Apple&rsquo;s instructions</a>.</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> We encountered challenges when executing XLB on Apple GPUs due to the lack of support for certain operations in the Metal backend. We advise using the CPU backend on Mac OS. We will be testing XLB on Apple&rsquo;s GPUs in the future and will update this section accordingly.</p>
<p>Install dependencies:</p>
<div class="codehilite"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>pyvista<span class="w"> </span>numpy<span class="w"> </span>matplotlib<span class="w"> </span>Rtree<span class="w"> </span>trimesh<span class="w"> </span>jmp<span class="w"> </span>orbax-checkpoint<span class="w"> </span>termcolor
</code></pre></div>

<p>Run an example:</p>
<div class="codehilite"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/piyush-ppradhan/JAX-LaB
<span class="nb">cd</span><span class="w"> </span>JAX-LaB
<span class="nb">export</span><span class="w"> </span><span class="nv">PYTHONPATH</span><span class="o">=</span>.
python3<span class="w"> </span>examples/singlephase/cavity2d.py
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": ".", "features": ["header.autohide"], "search": "assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>